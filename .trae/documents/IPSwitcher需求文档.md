# IP切换控制台程序需求文档

## 1. 项目概述

IP切换控制台程序是一个基于.NET 4.8平台开发的C#控制台应用，用于帮助用户快速切换Windows 11系统中网络适配器的IP配置。程序支持通过配置文件管理多个网络配置方案，实现一键切换IP地址及相关网络参数。

## 2. 开发环境与运行要求

| 项目   | 要求                        |
| ---- | ------------------------- |
| 开发平台 | .NET 4.8                  |
| 编程语言 | C#                        |
| 运行环境 | Windows 11                |
| 运行权限 | 管理员权限                     |
| 依赖项  | 无额外依赖，使用.NET Framework内置库 |

## 3. 核心功能需求

### 3.1 网卡管理功能

* **功能描述**：程序启动时自动扫描系统中所有可用网络适配器

* **显示信息**：网卡名称、类型、当前连接状态

* **实现方式**：使用WMI或.NET NetworkInterface类获取网卡信息

### 3.2 网卡选择功能

* **功能描述**：提供控制台交互界面，允许用户手动选择目标网卡

* **交互方式**：列表形式展示网卡，用户通过输入序号选择

* **验证机制**：确保用户选择的网卡有效且支持IP配置

### 3.3 配置文件管理

* **功能描述**：支持通过配置文件导入IP相关配置信息

* **配置项**：IP地址、子网掩码、默认网关、DNS服务器等

* **加载方式**：程序启动时自动加载默认配置文件，支持手动指定配置文件路径

### 3.4 IP配置切换

* **功能描述**：根据用户选择的网卡和配置文件内容，执行IP配置切换

* **操作内容**：修改IP地址、子网掩码、默认网关、DNS服务器

* **验证机制**：配置切换后验证网络参数是否正确应用

## 4. 操作流程

```
程序启动 → 自动扫描网卡 → 显示网卡列表 → 用户选择网卡 → 
加载配置文件 → 用户选择配置方案 → 执行IP配置切换 → 
验证配置结果 → 显示操作结果及当前配置 → 程序退出
```

## 5. 配置文件格式

### 5.1 格式说明

* 使用XML或JSON格式存储配置信息

* 支持多个网络配置方案

* 每个配置方案包含完整的网络参数

### 5.2 配置文件示例（XML格式）

```xml
<IPConfigurations>
  <Configuration Name="办公室网络">
    <NicName>以太网</NicName>
    <IPAddress>192.168.1.100</IPAddress>
    <SubnetMask>255.255.255.0</SubnetMask>
    <DefaultGateway>192.168.1.1</DefaultGateway>
    <DnsServers>
      <Dns>8.8.8.8</Dns>
      <Dns>8.8.4.4</Dns>
    </DnsServers>
  </Configuration>
  <Configuration Name="家庭网络">
    <NicName>以太网</NicName>
    <IPAddress>10.0.0.5</IPAddress>
    <SubnetMask>255.255.255.0</SubnetMask>
    <DefaultGateway>10.0.0.1</DefaultGateway>
    <DnsServers>
      <Dns>114.114.114.114</Dns>
    </DnsServers>
  </Configuration>
</IPConfigurations>
```

### 5.3 配置文件示例（JSON格式）

```json
{
  "Configurations": [
    {
      "Name": "办公室网络",
      "NicName": "以太网",
      "IPAddress": "192.168.1.100",
      "SubnetMask": "255.255.255.0",
      "DefaultGateway": "192.168.1.1",
      "DnsServers": ["8.8.8.8", "8.8.4.4"]
    },
    {
      "Name": "家庭网络",
      "NicName": "以太网",
      "IPAddress": "10.0.0.5",
      "SubnetMask": "255.255.255.0",
      "DefaultGateway": "10.0.0.1",
      "DnsServers": ["114.114.114.114"]
    }
  ]
}
```

## 6. 控制台交互设计

### 6.1 启动界面

```
========================================
IP切换控制台程序 v1.0
========================================
正在扫描系统网卡...
```

### 6.2 网卡列表显示

```
可用网卡列表：
1. [已连接] 以太网 - 本地连接
2. [已断开] WLAN - 无线网络连接
3. [已连接] 蓝牙网络连接

请输入要配置的网卡序号：
```

### 6.3 配置方案选择

```
加载配置文件成功，发现以下配置方案：
1. 办公室网络
2. 家庭网络

请输入要应用的配置序号：
```

### 6.4 操作结果显示

```
正在应用配置...
配置应用成功！

当前网络配置详情：
网卡名称：以太网
IP地址：192.168.1.100
子网掩码：255.255.255.0
默认网关：192.168.1.1
DNS服务器：8.8.8.8, 8.8.4.4

按任意键退出程序...
```

### 6.5 错误提示示例

```
错误：权限不足，请以管理员身份运行程序！
错误：无效的网卡选择，请重新输入！
错误：配置文件格式错误，请检查配置文件！
错误：IP地址格式无效，请检查配置文件！
```

## 7. 非功能性需求

### 7.1 性能要求

* 网卡扫描时间：≤1秒

* IP配置切换时间：≤5秒

* 配置验证时间：≤2秒

### 7.2 可靠性要求

* 配置切换成功率：≥99%

* 错误处理覆盖率：100%

* 支持异常恢复机制

### 7.3 易用性要求

* 操作步骤≤3步

* 提供清晰的操作指引

* 支持命令行参数（可选）

### 7.4 安全性要求

* 以管理员权限运行

* 配置文件加密（可选）

* 操作日志记录

## 8. 错误处理机制

| 错误类型     | 处理方式            |
| -------- | --------------- |
| 权限不足     | 提示用户以管理员身份运行    |
| 无效网卡选择   | 显示错误信息并重新提示选择   |
| 配置文件格式错误 | 显示具体错误位置并退出     |
| IP地址格式无效 | 显示错误信息并退出       |
| 配置应用失败   | 显示失败原因并回滚（如果可能） |
| 网络连接异常   | 显示警告信息但继续执行     |

## 9. 日志功能

### 9.1 日志内容

* 程序启动时间

* 网卡扫描结果

* 用户操作记录

* 配置切换结果

* 错误信息

### 9.2 日志格式

```
[2025-12-17 14:30:00] 程序启动
[2025-12-17 14:30:01] 扫描到3个网卡
[2025-12-17 14:30:05] 用户选择网卡：以太网
[2025-12-17 14:30:08] 应用配置：办公室网络
[2025-12-17 14:30:12] 配置应用成功
[2025-12-17 14:30:15] 程序退出
```

### 9.3 日志存储

* 默认存储路径：程序目录下的Logs文件夹

* 日志文件名：IPSwitcher\_yyyyMMdd.log

* 日志滚动策略：每日创建新日志文件，保留最近7天日志

## 10. 命令行参数支持（可选）

| 参数            | 描述       | 示例                                        |
| ------------- | -------- | ----------------------------------------- |
| -c, --config  | 指定配置文件路径 | IPSwitcher.exe -c D:\configs\network.json |
| -n, --nic     | 指定网卡名称   | IPSwitcher.exe -n "以太网"                   |
| -p, --profile | 指定配置方案名称 | IPSwitcher.exe -p "办公室网络"                 |
| -h, --help    | 显示帮助信息   | IPSwitcher.exe -h                         |
| -v, --version | 显示版本信息   | IPSwitcher.exe -v                         |

## 11. 部署要求

### 11.1 部署包内容

* IPSwitcher.exe（主程序）

* config.json（默认配置文件模板）

* README.txt（使用说明）

### 11.2 安装方式

* 无需安装，直接解压即可使用

* 建议创建桌面快捷方式，并设置以管理员身份运行

### 11.3 更新方式

* 替换主程序文件即可完成更新

* 配置文件向后兼容

## 12. 测试要求

### 12.1 功能测试

* 网卡扫描功能测试

* 网卡选择功能测试

* 配置文件加载测试

* IP配置切换功能测试

* 配置验证功能测试

### 12.2 边界测试

* 无效网卡选择测试

* 错误配置文件测试

* 权限不足测试

* 网络异常测试

### 12.3 性能测试

* 多网卡扫描性能测试

* 频繁配置切换测试

* 大规模配置文件测试

## 13. 验收标准

1. 程序能在Windows 11上正常运行
2. 程序能正确扫描并显示所有网卡
3. 用户能成功选择并配置目标网卡
4. 程序能正确加载和应用配置文件
5. IP配置切换成功率达到100%
6. 程序提供清晰的操作指引和错误提示
7. 程序能正确记录操作日志
8. 程序在各种异常情况下能稳定运行

## 14. 项目计划

| 阶段   | 主要任务             | 时间估算 |
| ---- | ---------------- | ---- |
| 需求分析 | 完成需求文档编写         | 1天   |
| 设计阶段 | 架构设计、类设计、配置文件设计  | 1天   |
| 开发阶段 | 核心功能开发、错误处理、日志功能 | 3天   |
| 测试阶段 | 功能测试、边界测试、性能测试   | 2天   |
| 部署阶段 | 打包、文档编写、发布       | 1天   |

## 15. 附录

### 15.1 术语定义

* 网络适配器：又称网卡，用于连接计算机与网络

* IP地址：互联网协议地址，用于标识网络中的设备

* 子网掩码：用于划分网络地址和主机地址

* 默认网关：连接不同网络的设备

* DNS服务器：域名系统服务器，用于将域名转换为IP地址

### 15.2 参考文档

* [.NET Framework 4.8文档](https://docs.microsoft.com/zh-cn/dotnet/framework/)

* [Windows网络配置命令](https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/ipconfig)

* [C# NetworkInterface类](https://docs.microsoft.com/zh-cn/dotnet/api/system.net.networkinformation.networkinterface)

### 15.3 联系方式

* 开发人员：\[姓名]

* 联系方式：\[邮箱/电话]

* 项目地址：\[GitHub/GitLab地址]

***

**文档版本**：v1.0\
**编写日期**：2025-12-17\
**审核人员**：\[审核人姓名]\
**批准日期**：\[批准日期]
